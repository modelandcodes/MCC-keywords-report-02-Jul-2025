<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCC Keyword Ranking Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .table-header-sortable {
            cursor: pointer;
            position: relative;
        }
        .table-header-sortable::after {
            content: ' \2195'; /* Up-down arrow */
            opacity: 0.4;
            position: absolute;
            right: 0.5rem;
        }
        .table-header-sortable.asc::after {
            content: ' \2191'; /* Up arrow */
            opacity: 1;
        }
        .table-header-sortable.desc::after {
            content: ' \2193'; /* Down arrow */
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <!-- Header Section -->
        <header class="mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">Keyword Performance Dashboard</h1>
            <p class="text-lg text-gray-600 mt-2">An overview of your MCC's search engine rankings local as of July 2, 2025.</p>
        </header>

        <!-- All Keywords Visualization -->
        <section class="mb-12 bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">All Keyword Rankings Visualization</h2>
            <p class="text-gray-600 mb-4 text-sm">Displaying all keywords from report, sorted by best rank. You can scroll within the chart area below to see all entries.</p>
            <div class="relative w-full" style="height: 80vh;">
                 <div class="absolute top-0 left-0 right-0 bottom-0 overflow-y-auto pr-4">
                    <canvas id="rankingChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Full Keyword Ranking Table -->
        <section class="bg-white p-6 rounded-xl shadow-lg">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">All Keyword Rankings</h2>
            
            <!-- Search/Filter Input -->
            <div class="mb-4">
                <input type="text" id="searchInput" placeholder="Search for a keyword..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
            </div>

            <!-- Table Container for scrolling on small screens -->
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider table-header-sortable" onclick="sortTable(0, 'string')">
                                Keyword
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider table-header-sortable asc" onclick="sortTable(1, 'number')">
                                Position
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider table-header-sortable" onclick="sortTable(2, 'string')">
                                Landing Page
                            </th>
                        </tr>
                    </thead>
                    <tbody id="keywordTableBody" class="bg-white divide-y divide-gray-200">
                        <!-- Table rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Footer -->
        <footer class="text-center mt-12 py-6 border-t border-gray-200">
            <p class="text-sm text-gray-500">Dashboard generated by umal</p>
        </footer>
    </div>

    <script>
        const rawData = `Keyword;*.melbournecentralconveyancing.com.au/*_20250701;*.melbournecentralconveyancing.com.au/*_20250701_visibility;*.melbournecentralconveyancing.com.au/*_20250701_type;*.melbournecentralconveyancing.com.au/*_20250701_landing;*.melbournecentralconveyancing.com.au/*_difference;*.melbournecentralconveyancing.com.au/*_visibility_difference;Tags;Intents;CPC;Search Volume;Keyword Difficulty
conveyancing fees melbourne;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/cheap-conveyancing-in-melbourne/;0;0;;"i";3.81;170;6
cooling off period victoria;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/understanding-the-cooling-off-period-in-victoria-your-guide-to-property-purchases/;0;0;;"i";; ;6
deposit on house;1;0.3861;featured snippet;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";; ;28
do all contracts have a cooling-off period australia;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/cooling-off-period-in-victoria/;0;0;;"i";; ;24
home buying deposit;1;0.3861;featured snippet;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";1.63;40;38
how do i get a section 32 in victoria;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/how-to-get-a-section-32-in-victoria-a-step-by-step-guide/;0;0;;"i";1.96;30;8
how much does a section 32 cost in victoria;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/how-much-does-a-section-32-cost-in-victoria-heres-why-its-free-with-melbourne-central-conveyancing/;0;0;;"i";2.18;30;5
initial deposit vs balance deposit;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i|c";;10;5
real estate deposit rules victoria;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";;110;6
section 32;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/3-what-is-in-a-section-32-key-elements-explained/;0;0;;"i";0.65;2400;19
victoria cooling off period;1;0.3861;ai overview;https://www.melbournecentralconveyancing.com.au/understanding-the-cooling-off-period-in-victoria-your-guide-to-property-purchases/;0;0;;"i";; ;6
deposit for house purchase;2;0.13259;organic;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";1.63;40;35
deposit on house purchase;2;0.13259;organic;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";; ;29
deposit when buying a house;2;0.13259;organic;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";1.63;40;10
how to get a section 32;2;0.13259;site links;https://www.melbournecentralconveyancing.com.au/how-to-get-a-section-32-in-victoria-a-step-by-step-guide/;0;0;;"i";2.44;40;17
section 32 cost;2;0.13259;site links;https://www.melbournecentralconveyancing.com.au/how-much-does-a-section-32-cost-in-victoria-heres-why-its-free-with-melbourne-central-conveyancing/;0;0;;"i";2.7;40;6
conveyancer springvale;3;0.10077;local;https://melbournecentralconveyancing.com.au/;0;0;;"c";3.75;90;5
deposit on home purchase;3;0.10077;organic;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";; ;39
title transfer;3;0.10077;organic;https://www.melbournecentralconveyancing.com.au/title-transfer/;0;0;;"i";0.74;20;25
when does a cooling off period start;3;0.10077;organic;https://www.melbournecentralconveyancing.com.au/cooling-off-period-in-victoria/;0;0;;"i";;20;12
when do you pay deposit on house;4;0.0831;organic;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";1.63;40;10
what is a section 32 victoria;4;0.0831;organic;https://www.melbournecentralconveyancing.com.au/what-is-a-section-32-vendor-statement-in-victoria/;0;0;;"i";; ;10
what is section 32;5;0.0712;organic;https://www.melbournecentralconveyancing.com.au/3-what-is-in-a-section-32-key-elements-explained/;0;0;;"i";;20;15
what is section 32 victoria;5;0.0712;organic;https://www.melbournecentralconveyancing.com.au/what-is-a-section-32-vendor-statement-in-victoria/;0;0;;"i";; ;10
what is a section 32;5;0.0712;organic;https://www.melbournecentralconveyancing.com.au/3-what-is-in-a-section-32-key-elements-explained/;0;0;;"i";;20;15
what is the section 32;5;0.0712;organic;https://www.melbournecentralconveyancing.com.au/3-what-is-in-a-section-32-key-elements-explained/;0;0;;"i";;20;15
how long is cooling off period when buying a house;5;0.0712;organic;https://www.melbournecentralconveyancing.com.au/understanding-the-cooling-off-period-in-victoria-your-guide-to-property-purchases/;0;0;;"i";; ;11
s32 property;6;0.0624;organic;https://www.melbournecentralconveyancing.com.au/3-what-is-in-a-section-32-key-elements-explained/;0;0;;"i";;20;15
what is a section 32 in real estate;6;0.0624;organic;https://www.melbournecentralconveyancing.com.au/what-is-a-section-32-vendor-statement-in-victoria/;0;0;;"i";; ;10
what is section 32 in real estate;6;0.0624;organic;https://www.melbournecentralconveyancing.com.au/what-is-a-section-32-vendor-statement-in-victoria/;0;0;;"i";; ;10
how long does a section 32 last;6;0.0624;organic;https://www.melbournecentralconveyancing.com.au/how-long-is-a-section-32-valid-for-in-victoria/;0;0;;"i";; ;10
when does the cooling off period start;7;0.0556;organic;https://www.melbournecentralconveyancing.com.au/cooling-off-period-in-victoria/;0;0;;"i";;20;12
conveyancing costs victoria;7;0.0556;organic;https://www.melbournecentralconveyancing.com.au/conveyancing-costs-victoria-a-detailed-breakdown-of-fees/;0;0;;"i";; ;10
what happens after cooling off period;7;0.0556;organic;https://www.melbournecentralconveyancing.com.au/what-happens-after-the-cooling-off-period-in-victoria/;0;0;;"i";; ;10
cooling off period in victoria;8;0.0499;organic;https://www.melbournecentralconveyancing.com.au/cooling-off-period-in-victoria/;0;0;;"i";; ;6
section 32 victoria;8;0.0499;organic;https://www.melbournecentralconveyancing.com.au/what-is-a-section-32-vendor-statement-in-victoria/;0;0;;"i";; ;10
cooling off period;9;0.0451;organic;https://www.melbournecentralconveyancing.com.au/understanding-the-cooling-off-period-in-victoria-your-guide-to-property-purchases/;0;0;;"i";; ;11
conveyancing melbourne;9;0.0451;organic;https://melbournecentralconveyancing.com.au/;0;0;;"i";; ;10
section 32 real estate;9;0.0451;organic;https://www.melbournecentralconveyancing.com.au/what-is-a-section-32-vendor-statement-in-victoria/;0;0;;"i";; ;10
initial deposit;10;0.0411;organic;https://www.melbournecentralconveyancing.com.au/property-deposits-in-melbourne-victoria-a-complete-guide-for-buyers-and-sellers/;0;0;;"i";; ;10
conveyancers in melbourne;10;0.0411;organic;https://melbournecentralconveyancing.com.au/;0;0;;"i";; ;10
cooling off period when buying a house;11;0.0377;organic;https://www.melbournecentralconveyancing.com.au/understanding-the-cooling-off-period-in-victoria-your-guide-to-property-purchases/;0;0;;"i";; ;11
conveyancing in melbourne;11;0.0377;organic;https://melbournecentralconveyancing.com.au/;0;0;;"i";; ;10
average conveyancing fees victoria;12;0.0348;organic;https://www.melbournecentralconveyancing.com.au/conveyancing-costs-victoria-a-detailed-breakdown-of-fees/;0;0;;"i";; ;10
how long is a section 32 valid for in victoria;12;0.0348;organic;https://www.melbournecentralconveyancing.com.au/how-long-is-a-section-32-valid-for-in-victoria/;0;0;;"i";; ;10
conveyancing services melbourne;12;0.0348;organic;https://melbournecentralconveyancing.com.au/;0;0;;"i";; ;10
real estate cooling off period;13;0.0322;organic;https://www.melbournecentralconveyancing.com.au/understanding-the-cooling-off-period-in-victoria-your-guide-to-property-purchases/;0;0;;"i";; ;11
cooling off period contract;13;0.0322;organic;https://www.melbournecentralconveyancing.com.au/understanding-the-cooling-off-period-in-victoria-your-guide-to-property-purchases/;0;0;;"i";; ;11
cooling off period for vendors victoria;13;0.0322;organic;https://www.melbournecentralconveyancing.com.au/can-a-seller-pull-out-of-a-contract-of-sale-in-victoria/;0;0;;"i";; ;10
`;

        // --- Data Processing ---
        function parseData(rawData) {
            const rows = rawData.trim().split('\n');
            const header = rows.shift().split(';');
            
            // Find the correct indices for the columns we need
            const keywordIndex = header.indexOf('Keyword');
            const positionIndex = 1; // It's always the second column
            const landingPageIndex = 4; // It's always the fifth column

            return rows.map(row => {
                const columns = row.split(';');
                if (columns.length < 5) return null; // Skip malformed rows
                const position = parseInt(columns[positionIndex], 10);
                
                if (isNaN(position) || position < 1) {
                    return null;
                }
                return {
                    keyword: columns[keywordIndex] || 'N/A',
                    position: position,
                    landingPage: columns[landingPageIndex] || 'N/A'
                };
            }).filter(item => item !== null); // Filter out invalid entries
        }

        const keywordData = parseData(rawData);

        // --- Chart.js Visualization ---
        // Use all keywords for the chart, sorted by position
        const allKeywordsForChart = [...keywordData].sort((a, b) => a.position - b.position);

        const ctx = document.getElementById('rankingChart').getContext('2d');
        const rankingChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: allKeywordsForChart.map(d => d.keyword),
                datasets: [{
                    label: 'Google Rank (Position)',
                    data: allKeywordsForChart.map(d => d.position),
                    backgroundColor: allKeywordsForChart.map(d => {
                        if (d.position <= 3) return 'rgba(75, 192, 192, 0.8)'; // Green
                        if (d.position <= 10) return 'rgba(255, 159, 64, 0.8)'; // Orange
                        return 'rgba(255, 99, 132, 0.8)'; // Red
                    }),
                    borderColor: allKeywordsForChart.map(d => {
                        if (d.position <= 3) return 'rgba(75, 192, 192, 1)';
                        if (d.position <= 10) return 'rgba(255, 159, 64, 1)';
                        return 'rgba(255, 99, 132, 1)';
                    }),
                    borderWidth: 1,
                    barThickness: 12,
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        beginAtZero: true,
                        reverse: true,
                        ticks: {
                            stepSize: 1
                        },
                        grid: {
                            display: true,
                            color: 'rgba(200, 200, 200, 0.1)'
                        }
                    },
                    y: {
                         ticks: {
                            font: {
                                size: 10
                            }
                         },
                         grid: {
                            display: false
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `Position: ${context.raw}`;
                            }
                        }
                    }
                }
            }
        });

        // --- Table Population and Functionality ---
        const tableBody = document.getElementById('keywordTableBody');
        let currentSort = { column: 1, order: 'asc' }; // Initial sort by position

        function renderTable(data) {
            tableBody.innerHTML = '';
            data.forEach(item => {
                const row = document.createElement('tr');
                row.className = "hover:bg-gray-50 transition-colors";
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900">${item.keyword}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${item.position <= 3 ? 'bg-green-100 text-green-800' : item.position <= 10 ? 'bg-orange-100 text-orange-800' : 'bg-red-100 text-red-800'}">
                            ${item.position}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 truncate" title="${item.landingPage}">
                        <a href="${item.landingPage}" target="_blank" class="hover:text-blue-600">${item.landingPage}</a>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // Sorting function
        function sortTable(columnIndex, type) {
            const headers = document.querySelectorAll('.table-header-sortable');
            const order = (currentSort.column === columnIndex && currentSort.order === 'asc') ? 'desc' : 'asc';

            const sortedData = [...keywordData].sort((a, b) => {
                let valA, valB;
                if (columnIndex === 0) { valA = a.keyword; valB = b.keyword; }
                if (columnIndex === 1) { valA = a.position; valB = b.position; }
                if (columnIndex === 2) { valA = a.landingPage; valB = b.landingPage; }

                if (type === 'number') {
                    return order === 'asc' ? valA - valB : valB - valA;
                } else {
                    return order === 'asc' ? valA.localeCompare(valB) : valB.localeCompare(valA);
                }
            });
            
            headers.forEach(h => h.classList.remove('asc', 'desc'));
            headers[columnIndex].classList.add(order);

            currentSort = { column: columnIndex, order: order };
            renderTable(sortedData);
        }

        // Search/filter function
        document.getElementById('searchInput').addEventListener('keyup', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const filteredData = keywordData.filter(item => {
                return item.keyword.toLowerCase().includes(searchTerm);
            });
            renderTable(filteredData);
        });

        // Initial render
        sortTable(1, 'number'); // Sort by position ascending initially

    </script>
</body>
</html>

